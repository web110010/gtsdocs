<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Firewall # You should deploy a firewall on your instance to close off any open ports and give you a mechanism to ban potentially misbehaving clients. Many firewall frontends will also automatically install some rules that block obvious malicious packets.
It can be helpful to deploy tools that monitor your log files for certain patterns and automatically ban clients exhibiting certain behaviour. This can be use to monitor your SSH and web server access logs for things like SSH brute-force attacks.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="" />
<meta property="og:description" content="Firewall # You should deploy a firewall on your instance to close off any open ports and give you a mechanism to ban potentially misbehaving clients. Many firewall frontends will also automatically install some rules that block obvious malicious packets.
It can be helpful to deploy tools that monitor your log files for certain patterns and automatically ban clients exhibiting certain behaviour. This can be use to monitor your SSH and web server access logs for things like SSH brute-force attacks." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/docs/advanced/security/firewall/" /><meta property="article:section" content="docs" />



<title>Firewall |  GoToSocial Documentation </title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.f8de3645fe00591b41524aee174e19edd98a22255a2930a0cdc82a94835ba387.css" integrity="sha256-&#43;N42Rf4AWRtBUkruF04Z7dmKIiVaKTCgzcgqlINbo4c=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.611c5c1febb7934f5bf0513e18b80edbb8ef94a70c6bcfdb5d454501232b51e4.js" integrity="sha256-YRxcH&#43;u3k09b8FE&#43;GLgO27jvlKcMa8/bXUVFASMrUeQ=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
  <link href="/css/swagger-css/swagger-ui.css" rel="stylesheet" type="text/css">
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/favicon.ico" alt="Logo" /><span> GoToSocial Documentation </span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/docs/faq/" class="">FAQ</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0b8a4f04ff43ad74e1f0264bbdf6f4e1" class="toggle"  />
    <label for="section-0b8a4f04ff43ad74e1f0264bbdf6f4e1" class="flex justify-between">
      <a role="button" class="">User Guide</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/user_guide/posts/" class="">Posts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/user_guide/settings/" class="">Settings</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/user_guide/custom_css/" class="">Custom CSS (Advanced)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/user_guide/password_management/" class="">Password Management</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/user_guide/rss/" class="">RSS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d0d8c0b66b8e3c4a41d9a7a903279018" class="toggle"  />
    <label for="section-d0d8c0b66b8e3c4a41d9a7a903279018" class="flex justify-between">
      <a role="button" class="">Getting Started</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/deployment_considerations/" class="">Deployment Considerations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/releases/" class="">Releases</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4dd3c8f7579de11397af9a616dd97623" class="toggle"  />
    <label for="section-4dd3c8f7579de11397af9a616dd97623" class="flex justify-between">
      <a href="/docs/getting_started/installation/" class="">Installation</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/installation/metal/" class="">Bare metal</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/installation/container/" class="">Container</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-227ed35e8d3d1d9ae6ada088eaa5826a" class="toggle"  />
    <label for="section-227ed35e8d3d1d9ae6ada088eaa5826a" class="flex justify-between">
      <a href="/docs/getting_started/reverse_proxy/" class="">Reverse Proxy</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/reverse_proxy/nginx/" class="">Nginx</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/reverse_proxy/apache-httpd/" class="">Apache Httpd</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/reverse_proxy/caddy/" class="">Caddy 2</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/reverse_proxy/websocket/" class="">Websocket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/getting_started/user_creation/" class="">User Creation</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-733eb6bf92c2240d3439f44b52d0e508" class="toggle"  />
    <label for="section-733eb6bf92c2240d3439f44b52d0e508" class="flex justify-between">
      <a href="/docs/configuration/" class="">Configuration</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/general/" class="">General</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/database/" class="">Database</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/web/" class="">Web</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/instance/" class="">Instance</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/accounts/" class="">Accounts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/media/" class="">Media</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/storage/" class="">Storage</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/statuses/" class="">Statuses</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/tls/" class="">TLS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/oidc/" class="">OpenID Connect (OIDC)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/smtp/" class="">Email Config (smtp)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/syslog/" class="">Syslog</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/advanced/" class="">Advanced</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/configuration/observability/" class="">Observability</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-947fb6d312b5241daf9523c924869228" class="toggle" checked />
    <label for="section-947fb6d312b5241daf9523c924869228" class="flex justify-between">
      <a href="/docs/advanced/" class="">Advanced</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/host-account-domain/" class="">Split-domain deployments</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/outgoing-proxy/" class="">Outgoing HTTP proxy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76875d46ccfca56452024158a33d8109" class="toggle"  />
    <label for="section-76875d46ccfca56452024158a33d8109" class="flex justify-between">
      <a href="/docs/advanced/caching/" class="">Caching</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/caching/api/" class="">API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/caching/assets-media/" class="">Assets Media</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/certificates/" class="">Provisioning TLS certificates</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-010cc1241fb55df50712cba4c805f74e" class="toggle" checked />
    <label for="section-010cc1241fb55df50712cba4c805f74e" class="flex justify-between">
      <a href="/docs/advanced/security/" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/security/sandboxing/" class="">Application sandboxing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/security/firewall/" class="active">Firewall</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/advanced/tracing/" class="">Tracing</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d3501c3f4c7ea3fb09a3bb156b24beda" class="toggle"  />
    <label for="section-d3501c3f4c7ea3fb09a3bb156b24beda" class="flex justify-between">
      <a role="button" class="">Admin</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/admin/settings/" class="">Admin Settings</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/admin/cli/" class="">GtS CLI Tool</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/admin/backup_and_restore/" class="">Backup and Restore</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-901779afe5996ea4448e3bb3d55a2b9f" class="toggle"  />
    <label for="section-901779afe5996ea4448e3bb3d55a2b9f" class="flex justify-between">
      <a href="/docs/federation/" class="">Federation</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/federation/glossary/" class="">Glossary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/federation/federating_with_gotosocial/" class="">Federating With Gotosocial</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bf7b3283e3790c00c8caaa140299052b" class="toggle"  />
    <label for="section-bf7b3283e3790c00c8caaa140299052b" class="flex justify-between">
      <a role="button" class="">API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/api/swagger/" class="">Swagger</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/api/ratelimiting/" class="">Request Rate Limiting</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/api/throttling/" class="">Request Throttling</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Firewall</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#ports">Ports</a></li>
    <li><a href="#icmp">ICMP</a>
      <ul>
        <li><a href="#ipv4">IPv4</a></li>
        <li><a href="#ipv6">IPv6</a></li>
      </ul>
    </li>
    <li><a href="#firewall-configuration">Firewall configuration</a></li>
    <li><a href="#brute-force-protection">Brute-force protection</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="firewall">
  Firewall
  <a class="anchor" href="#firewall">#</a>
</h1>
<p>You should deploy a firewall on your instance to close off any open ports and give you a mechanism to ban potentially misbehaving clients. Many firewall frontends will also automatically install some rules that block obvious malicious packets.</p>
<p>It can be helpful to deploy tools that monitor your log files for certain patterns and automatically ban clients exhibiting certain behaviour. This can be use to monitor your SSH and web server access logs for things like SSH brute-force attacks.</p>
<h2 id="ports">
  Ports
  <a class="anchor" href="#ports">#</a>
</h2>
<p>For GoToSocial, you&rsquo;ll want to ensure port <code>443</code> remains open. Without it, nobody will be able to reach your instance. Federation will fail and client apps won&rsquo;t be able to work at all.</p>
<p>If you <a href="../../certificates">provision TLS certificates</a> using ACME or GoToSocial&rsquo;s built-in Lets Encrypt support, you&rsquo;ll also need port <code>80</code> to be open.</p>
<p>In order to access your instance over SSH, you&rsquo;ll need to keep the port your SSH daemon is bound on open too. By default this is port <code>22</code>.</p>
<h2 id="icmp">
  ICMP
  <a class="anchor" href="#icmp">#</a>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol">Internet Control Message Protocol</a> are exchanged between machines in order to detect certain network conditions or troubleshoot things. Many firewalls have a tendency of blocking ICMP entirely but this is undesirable. A few ICMP types should be allowed and you can use your firewall to configure rate limiting for them instead.</p>
<h3 id="ipv4">
  IPv4
  <a class="anchor" href="#ipv4">#</a>
</h3>
<p>In order for things to work reliably, your firewall must allow:</p>
<ul>
<li>ICMP Type 3: &ldquo;Destination Unreachable&rdquo; and also aids in Path-MTU Discovery</li>
<li>ICMP Type 4: &ldquo;Source Quench&rdquo;</li>
</ul>
<p>If you want to be able to ping things or be pinged, you should also allow:</p>
<ul>
<li>ICMP Type 0: &ldquo;Echo Reply&rdquo;</li>
<li>ICMP Type 8: &ldquo;Echo Request&rdquo;</li>
</ul>
<p>For traceroute to work, it can be helpful to also allow:</p>
<ul>
<li>ICMP Type 11: &ldquo;Time Exceeded&rdquo;</li>
</ul>
<h3 id="ipv6">
  IPv6
  <a class="anchor" href="#ipv6">#</a>
</h3>
<p>ICMP is heavily relied on by all parts of the IPv6 stack and things will break in exciting and hard to debug ways if you block it. <a href="https://www.rfc-editor.org/rfc/rfc4890">RFC 4890</a> was specifically written to address this and is worthwhile to review.</p>
<p>Roughly speaking, you must always allow:</p>
<ul>
<li>ICMP Type 1: &ldquo;Destination Unreachable&rdquo;</li>
<li>ICMP Type 2: &ldquo;Packet Too Big&rdquo;</li>
<li>ICMP Type 3, code 0: &ldquo;Time Exceeded&rdquo;</li>
<li>ICMP Type 4, code 1, 2: &ldquo;Parameter Problem&rdquo;</li>
</ul>
<p>For ping, you should allow:</p>
<ul>
<li>ICMP Type 128: &ldquo;Echo Request&rdquo;</li>
<li>ICMP Type 129: &ldquo;Echo Response&rdquo;</li>
</ul>
<h2 id="firewall-configuration">
  Firewall configuration
  <a class="anchor" href="#firewall-configuration">#</a>
</h2>
<p>On Linux, firewalling is typically done using either <a href="https://en.wikipedia.org/wiki/Iptables">iptables</a> or the more modern and faster <a href="https://en.wikipedia.org/wiki/Nftables">nftables</a> as the backend. Most distributions are switching to nftables and many firewall frontends can be configured to use nftables instead. You&rsquo;ll need to refer to your distribution&rsquo;s documentation on the matter, but typically there will be an <code>iptables</code> or <code>nftables</code> service your init-system can start with a predefined location to load firewall rules from.</p>
<p>Doing this by hand using raw iptables or nftables rules offers the most control but can be challenging if you&rsquo;re not familiar with these systems. In order to help with that, a number of configuration frontends exist that you can use.</p>
<p>On the Debian and Ubuntu as well as openSUSE family of distributions, UFW is commonly used. It&rsquo;s a simple firewall front-end and many tutorials targeting those distributions will be using it.</p>
<p>For the Red Hat/CentOS family of distributions, firewalld is typically used. It&rsquo;s a much more advanced firewall configuration utility which also has a desktop GUI and <a href="https://cockpit-project.org/">Cockpit integration</a>.</p>
<p>Despite distribution preferences, you can use UFW, firewalld or something else entirely with any Linux distribution.</p>
<ul>
<li><a href="https://wiki.ubuntu.com/UncomplicatedFirewall?action=show&amp;redirect=UbuntuFirewall">Ubuntu Wiki</a> on UFW</li>
<li><a href="https://wiki.archlinux.org/title/Uncomplicated_Firewall">ArchWiki</a> on UFW</li>
<li>Digital Ocean guide on <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04">using UFW with Ubuntu 22.04</a></li>
<li><a href="https://firewalld.org/">firewalld</a> project homepage and documentation</li>
<li><a href="https://wiki.archlinux.org/title/firewalld">ArchWiki</a> on firewalld</li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters">Using and configuring firewalld</a> from Red Hat</li>
<li>Linode guide <a href="https://www.linode.com/docs/guides/introduction-to-firewalld-on-centos/">on using firewalld</a></li>
</ul>
<h2 id="brute-force-protection">
  Brute-force protection
  <a class="anchor" href="#brute-force-protection">#</a>
</h2>
<p><a href="https://www.fail2ban.org">fail2ban</a> and <a href="https://www.sshguard.net/">SSHGuard</a> can be set up to monitor your log files for attempts to brute-force logins and other malicious behaviour. They can be configured to automatically insert firewall rules to block malicious IP addresses, either for a specific period of time or even indefinitely.</p>
<p>SSHGuard was initially designed just for SSH, but nowadays supports a variety of services. Fail2ban tends to support anything you can generate consistent log lines for, whereas SSHGuard&rsquo;s signature approach can catch more sophisticated or stealthy attacks as it computes an attack score over time.</p>
<p>Both SSHGuard and fail2ban ship with &ldquo;backends&rdquo; that can target iptables and nftables directly, or work with your frontend of choice like UFW or firewalld on Linux or pf on *BSD. Make sure you review their documentation on how to correctly configure it.</p>
<ul>
<li><a href="https://wiki.archlinux.org/title/Fail2ban">ArchWiki</a> on fail2ban</li>
<li>DigitalOcean guide on how to protect SSH with <a href="https://www.digitalocean.com/community/tutorial_collections/how-to-protect-ssh-with-fail2ban">fail2ban on Ubuntu</a></li>
<li>Linode guide on how to <a href="https://www.linode.com/docs/guides/using-fail2ban-to-secure-your-server-a-tutorial/">secure your server with fail2ban</a></li>
<li><a href="https://wiki.archlinux.org/title/sshguard">ArchWiki</a> on sshguard</li>
<li><a href="https://man.freebsd.org/cgi/man.cgi?query=sshguard&amp;sektion=8&amp;manpath=FreeBSD&#43;13.2-RELEASE&#43;and&#43;Ports">FreeBSD manual</a> for sshguard</li>
<li><a href="https://manpages.ubuntu.com/manpages/lunar/en/man7/sshguard-setup.7.html">SSHGuard setup</a> manual for Ubuntu</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#ports">Ports</a></li>
    <li><a href="#icmp">ICMP</a>
      <ul>
        <li><a href="#ipv4">IPv4</a></li>
        <li><a href="#ipv6">IPv6</a></li>
      </ul>
    </li>
    <li><a href="#firewall-configuration">Firewall configuration</a></li>
    <li><a href="#brute-force-protection">Brute-force protection</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












